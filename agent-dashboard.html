<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Agent Request | Realtor Guard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: #f4f4f4;
    }

    .container {
      max-width: 560px;
      margin: auto;
      padding: 16px;
    }

    h1 {
      margin-bottom: 12px;
    }

    .card {
      background: #fff;
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    label {
      display: block;
      font-weight: bold;
      margin-top: 12px;
      font-size: 14px;
    }

    input, select, textarea {
      width: 100%;
      padding: 12px;
      margin-top: 6px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
    }

    textarea {
      resize: vertical;
    }

    button {
      width: 100%;
      margin-top: 18px;
      padding: 14px;
      font-size: 18px;
      font-weight: bold;
      border: none;
      border-radius: 12px;
      background: #111;
      color: #fff;
      cursor: pointer;
    }

    .success {
      display: none;
      margin-top: 12px;
      padding: 12px;
      border-radius: 10px;
      background: #e7ffe7;
      border: 1px solid #bff0bf;
      font-weight: bold;
      color: #145214;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Request an Observer</h1>

    <div class="card">
      <label>Agent Name</label>
      <input id="agentName" placeholder="Your full name" />

      <label>Type of Visit</label>
      <select id="visitType" onchange="toggleOther()">
        <option>Property Showing</option>
        <option>Open House</option>
        <option>Other</option>
      </select>

      <div id="otherBox" style="display:none;">
        <label>Describe Visit</label>
        <textarea id="otherDesc" rows="3"></textarea>
      </div>

      <label>Property Number</label>
      <select id="propertyNumber">
        <option>Property 1</option>
        <option>Property 2</option>
        <option>Property 3</option>
      </select>

      <label>Property Address</label>
      <input id="address" placeholder="123 Main St" />

      <label>State</label>
      <select id="state"></select>

      <label>Time Zone</label>
      <select id="timeZone"></select>

      <label>Date</label>
      <input id="date" type="date" />

      <label>Time</label>
      <input id="time" type="time" />

      <button onclick="submitRequest()">Submit Request</button>

      <div id="success" class="success">
        âœ… Request sent to observer
      </div>
    </div>
  </div>

  <script>
    const REQUEST_KEY = "rg_agent_requests_v1";

    const STATES = [
      "AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA",
      "ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK",
      "OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"
    ];

    const TIME_ZONES = [
      "America/New_York",
      "America/Chicago",
      "America/Denver",
      "America/Phoenix",
      "America/Los_Angeles",
      "America/Anchorage",
      "Pacific/Honolulu"
    ];

    function toggleOther() {
      const type = document.getElementById("visitType").value;
      document.getElementById("otherBox").style.display =
        type === "Other" ? "block" : "none";
    }

    function submitRequest() {
      const agentName = agentNameEl().value.trim();
      const visitType = visitTypeEl().value;
      const otherDesc = otherDescEl().value.trim();
      const propertyNum = propertyNumEl().value;
      const address = addressEl().value.trim();
      const state = stateEl().value;
      const timeZone = timeZoneEl().value;
      const date = dateEl().value;
      const time = timeEl().value;

      if (!agentName || !address || !date || !time) {
        alert("Please fill in all required fields.");
        return;
      }

      const list = JSON.parse(localStorage.getItem(REQUEST_KEY)) || [];

      list.push({
        id: "req_" + Date.now(),
        agentName,
        visitType,
        description: visitType === "Other" ? otherDesc : "",
        propertyNumber: propertyNum,
        address: `${address}, ${state}`,
        date,
        time,
        timeZone,
        createdAt: new Date().toISOString()
      });

      localStorage.setItem(REQUEST_KEY, JSON.stringify(list));

      document.getElementById("success").style.display = "block";
    }

    function populate() {
      STATES.forEach(s => stateEl().innerHTML += `<option>${s}</option>`);
      TIME_ZONES.forEach(t => timeZoneEl().innerHTML += `<option>${t}</option>`);
      try {
        timeZoneEl().value = Intl.DateTimeFormat().resolvedOptions().timeZone;
      } catch {}
    }

    const agentNameEl = () => document.getElementById("agentName");
    const visitTypeEl = () => document.getElementById("visitType");
    const otherDescEl = () => document.getElementById("otherDesc");
    const propertyNumEl = () => document.getElementById("propertyNumber");
    const addressEl = () => document.getElementById("address");
    const stateEl = () => document.getElementById("state");
    const timeZoneEl = () => document.getElementById("timeZone");
    const dateEl = () => document.getElementById("date");
    const timeEl = () => document.getElementById("time");

    populate();
  </script>
</body>
</html>
