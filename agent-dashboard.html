<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Agent Dashboard | Realtor Guard</title>

<style>
:root{
  --navy:#0B2C4F;
  --border:#E5E7EB;
  --success:#16A34A;
  --danger:#B91C1C;
}
body{margin:0;font-family:Arial,sans-serif;color:var(--navy);}
.nav{padding:14px 18px;border-bottom:1px solid var(--border);font-weight:700;}
.page{max-width:820px;margin:auto;padding:24px;}
.card{border:1px solid var(--border);border-radius:12px;padding:16px;margin-top:16px;}
label{font-size:13px;margin-top:10px;display:block;}
input,select,textarea{width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid var(--border);}
textarea{min-height:80px;}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
@media(max-width:700px){.grid{grid-template-columns:1fr;}}
.btn{padding:12px;border:none;border-radius:10px;font-size:15px;cursor:pointer;}
.primary{background:var(--navy);color:white;width:100%;}
.success{background:var(--success);color:white;}
.danger{background:var(--danger);color:white;}
.row{display:flex;gap:10px;flex-wrap:wrap;}
.small{font-size:12px;color:#666;}
</style>
</head>

<body>

<div class="nav">üõ°Ô∏è Realtor Guard ‚Äî Agent Dashboard</div>

<div class="page">
<div id="content"></div>
</div>

<script>
const STATES=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];
let propertyCount=1;

function render(){
  const c=document.getElementById("content");
  const req=JSON.parse(localStorage.getItem("assignmentRequest"));

  if(!req){
    c.innerHTML=requestForm();
    renderProperties();
    return;
  }

  if(req.status==="pending"){
    c.innerHTML=`<div class="card"><b>Status:</b> Waiting for observer acceptance</div>`;
    return;
  }

  if(req.status==="accepted"){
    const o=req.observer||{
      name:"John Williams",
      vehicle:"Toyota Camry ‚Ä¢ 2021 ‚Ä¢ Black",
      rating:"4.9 ‚òÖ",
      phone:"5551234567"
    };
    c.innerHTML=`
      <div class="card">
        <b>Observer Assigned</b>
        <p>${o.name}</p>
        <p>${o.vehicle}</p>
        <p>${o.rating}</p>
        <div class="row">
          <button class="btn success" onclick="sms('${o.phone}')">Message Observer</button>
          <button class="btn danger" onclick="cancel()">Cancel Assignment</button>
        </div>
      </div>`;
  }
}

function requestForm(){
return `
<div class="card">
  <label>Agent Name</label>
  <input id="agentName"/>

  <div id="properties"></div>

  <div class="row">
    <button class="btn" onclick="addProperty()">+ Add Property</button>
  </div>

  <button class="btn primary" onclick="submit()">Submit Request</button>
  <div class="small">You can add up to 3 properties.</div>
</div>`;
}

function propertyBlock(i){
return `
<div class="card" id="prop${i}">
<b>Property ${i+1}</b>

<label>Street</label><input id="street${i}">
<label>City</label><input id="city${i}">

<label>State</label>
<select id="state${i}">
${STATES.map(s=>`<option>${s}</option>`).join("")}
</select>

<label>Zip</label><input id="zip${i}">

<label>Time Zone</label>
<select id="tz${i}">
<option>Eastern</option><option>Central</option><option>Mountain</option>
<option>Pacific</option><option>Alaska</option><option>Hawaii</option>
</select>

<label>Visit Type</label>
<select id="visit${i}" onchange="toggleOther(${i})">
<option>Showing</option><option>Open House</option><option>Other</option>
</select>

<div id="other${i}" style="display:none">
<label>Description</label><textarea id="desc${i}"></textarea>
</div>

<label>Date</label><input type="date" id="date${i}">

<label>Time</label>
<div class="row">
<select id="hour${i}">${[...Array(12)].map((_,h)=>`<option>${h+1}</option>`).join("")}</select>
<select id="min${i}"><option>00</option><option>15</option><option>30</option><option>45</option></select>
<select id="ampm${i}"><option>AM</option><option>PM</option></select>
</div>

${i>0?`<button class="btn danger" onclick="removeProperty(${i})">Delete Property</button>`:""}
</div>`;
}

function renderProperties(){
  const p=document.getElementById("properties");
  p.innerHTML="";
  for(let i=0;i<propertyCount;i++) p.innerHTML+=propertyBlock(i);
}

function addProperty(){
  if(propertyCount>=3) return alert("Maximum 3 properties allowed.");
  propertyCount++;
  renderProperties();
}

function removeProperty(i){
  document.getElementById(`prop${i}`).remove();
  propertyCount--;
  renderProperties();
}

function toggleOther(i){
  document.getElementById(`other${i}`).style.display=
    document.getElementById(`visit${i}`).value==="Other"?"block":"none";
}

function submit(){
  const properties=[];
  for(let i=0;i<propertyCount;i++){
    properties.push({
      street:street${i}.value,
      city:city${i}.value,
      state:state${i}.value,
      zip:zip${i}.value,
      timeZone:tz${i}.value,
      visitType:visit${i}.value,
      otherDesc:desc${i}?.value||"",
      date:date${i}.value,
      time:`${hour${i}.value}:${min${i}.value} ${ampm${i}.value}`
    });
  }
  localStorage.setItem("assignmentRequest",JSON.stringify({
    agentName:agentName.value,
    properties,
    status:"pending"
  }));
  render();
}

function sms(phone){ window.location.href=`sms:${phone}`; }
function cancel(){ localStorage.removeItem("assignmentRequest"); render(); }

render();
</script>

</body>
</html>  
    
 
