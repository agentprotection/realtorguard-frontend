<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Agent Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#f4f4f4}
.wrap{max-width:900px;margin:auto;padding:16px}
.card{background:#fff;border-radius:14px;padding:16px;margin-top:14px;
box-shadow:0 2px 8px rgba(0,0,0,.08)}
input,select,button,textarea{
  width:100%;padding:14px;margin-top:10px;
  border-radius:12px;font-size:16px;box-sizing:border-box
}
button{border:none;font-weight:900;background:#111;color:#fff}
.secondary{background:#fff;color:#111;border:1px solid #ccc}
.status{margin-top:8px;font-weight:900}
.pending{color:#6b7280}
.accepted{color:#2563eb}
.inroute{color:#16a34a}
.expired{color:#dc2626}
.note{font-size:13px;color:#6b7280;margin-top:8px}
</style>
</head>

<body>
<div class="wrap">
<h2>Agent Dashboard</h2>

<!-- FORM -->
<div class="card">
  <input id="agentName" placeholder="Agent Name">

  <input id="address" placeholder="Property Address">
  <input id="city" placeholder="City">

  <select id="state">
    <option value="">State</option>
    <option>AL</option><option>AK</option><option>AZ</option><option>AR</option>
    <option>CA</option><option>CO</option><option>CT</option><option>DE</option>
    <option>FL</option><option>GA</option><option>HI</option><option>ID</option>
    <option>IL</option><option>IN</option><option>IA</option><option>KS</option>
    <option>KY</option><option>LA</option><option>ME</option><option>MD</option>
    <option>MA</option><option>MI</option><option>MN</option><option>MS</option>
    <option>MO</option><option>MT</option><option>NE</option><option>NV</option>
    <option>NH</option><option>NJ</option><option>NM</option><option>NY</option>
    <option>NC</option><option>ND</option><option>OH</option><option>OK</option>
    <option>OR</option><option>PA</option><option>RI</option><option>SC</option>
    <option>SD</option><option>TN</option><option>TX</option><option>UT</option>
    <option>VT</option><option>VA</option><option>WA</option><option>WV</option>
    <option>WI</option><option>WY</option>
  </select>

  <input id="zip" placeholder="ZIP Code">

  <select id="timezone">
    <option value="">Time Zone</option>
    <option>Eastern</option>
    <option>Central</option>
    <option>Mountain</option>
    <option>Pacific</option>
  </select>

  <select id="visitType">
    <option value="">Visit Type</option>
    <option>Open House</option>
    <option>Showing</option>
    <option>Other</option>
  </select>

  <textarea id="otherDesc" placeholder="Description" style="display:none"></textarea>

  <!-- DATE CALENDAR -->
  <input id="date" type="date">

  <!-- TIME DROPDOWN (30 MIN, NON-MILITARY) -->
  <select id="time">
    <option value="">Time</option>
  </select>

  <select id="duration">
    <option value="">Duration</option>
    <option>30 minutes</option>
    <option>60 minutes</option>
    <option>90 minutes</option>
    <option>120 minutes</option>
    <option>150 minutes</option>
    <option>180 minutes</option>
    <option>210 minutes</option>
    <option>240 minutes</option>
  </select>

  <button id="btnRequest">Request Observer</button>
  <button id="btnRefresh" class="secondary">Refresh</button>

  <div class="note" id="msg"></div>
</div>

<!-- REQUEST LIST -->
<div class="card">
  <div id="list"></div>
</div>
</div>

<script>
const REQ_KEY="rg_agent_requests_v1";
const $=id=>document.getElementById(id);

const loadReq=()=>JSON.parse(localStorage.getItem(REQ_KEY))||[];
const saveReq=r=>localStorage.setItem(REQ_KEY,JSON.stringify(r));

/* build time dropdown */
(function buildTimes(){
  const t=$("time");
  const times=[];
  for(let h=8;h<=20;h++){
    for(let m=0;m<60;m+=30){
      let hh=h%12||12;
      let ap=h<12?"AM":"PM";
      let mm=m===0?"00":"30";
      times.push(`${hh}:${mm} ${ap}`);
    }
  }
  times.forEach(x=>{
    const o=document.createElement("option");
    o.textContent=o.value=x;
    t.appendChild(o);
  });
})();

/* visit type */
$("visitType").addEventListener("change",()=>{
  $("otherDesc").style.display=$("visitType").value==="Other"?"block":"none";
});

/* submit */
$("btnRequest").addEventListener("click",()=>{
  $("msg").textContent="";
  const data={
    agentName:$("agentName").value.trim(),
    address:$("address").value.trim(),
    city:$("city").value.trim(),
    state:$("state").value,
    zip:$("zip").value.trim(),
    timezone:$("timezone").value,
    visitType:$("visitType").value,
    other:$("otherDesc").value.trim(),
    date:$("date").value,
    time:$("time").value,
    duration:$("duration").value
  };

  if(!data.agentName||!data.address||!data.city||!data.state||!data.zip||
     !data.timezone||!data.visitType||!data.date||!data.time||!data.duration){
    $("msg").textContent="Complete required fields";
    return;
  }
  if(data.visitType==="Other"&&!data.other){
    $("msg").textContent="Complete required fields";
    return;
  }

  const reqs=loadReq();
  reqs.push({id:Date.now().toString(),...data});
  saveReq(reqs);
  render();
  $("msg").textContent="Request sent";
});

/* refresh form */
$("btnRefresh").addEventListener("click",()=>{
  document.querySelectorAll("input,select,textarea").forEach(e=>e.value="");
  $("otherDesc").style.display="none";
  $("msg").textContent="";
});

/* render list */
function render(){
  $("list").innerHTML="";
  loadReq().forEach(r=>{
    const d=document.createElement("div");
    d.className="card";
    d.innerHTML=`
      <b>${r.address}, ${r.city}, ${r.state} ${r.zip}</b>
      <div>${r.date} ${r.time}</div>
      <div class="status pending">Pending</div>
    `;
    $("list").appendChild(d);
  });
}
render();
</script>
</body>
</html>
